<!DOCTYPE html>
<html lang="en"><head>
<script src="raster-operations_files/libs/clipboard/clipboard.min.js"></script>
<script src="raster-operations_files/libs/quarto-html/tabby.min.js"></script>
<script src="raster-operations_files/libs/quarto-html/popper.min.js"></script>
<script src="raster-operations_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="raster-operations_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="raster-operations_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="raster-operations_files/libs/quarto-html/quarto-syntax-highlighting-46eeb4c476de49ef7df495821a6125d9.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.19">

  <title>raster-operations</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="raster-operations_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="raster-operations_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="raster-operations_files/libs/revealjs/dist/theme/quarto-d8a14bde08cc4819f93bf0f91a6e5ba7.css">
  <link rel="stylesheet" href="misc/style-slides.css">
  <link href="raster-operations_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="raster-operations_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="raster-operations_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="raster-operations_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
<script src="mathjax-config.js"></script>
  <div class="reveal">
    <div class="slides">


<section>
<section id="raster-operations" class="title-slide slide level1 center">
<h1>Raster Operations</h1>

</section>
<section id="introduction" class="slide level2">
<h2>Introduction</h2>
<ul>
<li>Map algebra can be defined as operations that modify or summarize raster cell values, with reference to surrounding cells, zones, or statistical functions that apply to every cell.</li>
<li>Map algebra divides raster operations into four subclasses:
<ol type="1">
<li><strong>Local</strong> or per-cell operations</li>
<li><strong>Focal</strong> or neighborhood operations. Most often the output cell value is the result of a 3 x 3 input cell block</li>
<li><strong>Zonal</strong> operations are similar to focal operations, but the surrounding pixel grid on which new values are computed can have irregular sizes and shapes</li>
<li><strong>Global</strong> or per-raster operations. That means the output cell derives its value potentially from one or several entire rasters</li>
</ol></li>
</ul>
</section>
<section id="global-operation-1" class="slide level2">
<h2>Global Operation (1)</h2>
<ul>
<li>The most common global operations are descriptive statistics for the entire raster dataset such as the minimum, maximum or mean value.</li>
<li>For example: What is the mean elevation value for Luxembourg?</li>
</ul>

<img data-src="raster-operations_files/figure-html/fig-elev-1.png" width="672" class="r-stretch quarto-figure-center" id="fig-elev"><p class="caption">
Figure&nbsp;1: Elevation of Luxembourg
</p><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># note: mean(r) does not work, since "mean" is used as a local operator</span></span>
<span id="cb1-2"><a href="" aria-hidden="true" tabindex="-1"></a>mean_elev <span class="ot">&lt;-</span> <span class="fu">global</span>(r, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="" aria-hidden="true" tabindex="-1"></a>mean_elev</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>              mean
elevation 347.6488</code></pre>
</div>
</div>
</section>
<section id="sec-global-2" class="slide level2">
<h2>Global Operation (2)</h2>
<ul>
<li>Another type of ‚Äúglobal‚Äù operation is <code>distance</code></li>
<li>This function calculates the distance from each cell to a specific target cell</li>
<li>For example, what is the distance from each cell to <em>Luxembourg City</em>, the capital of Luxembourg?</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="raster-operations_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="" aria-hidden="true" tabindex="-1"></a>r_dist <span class="ot">&lt;-</span> <span class="fu">distance</span>(r, luxembourg_city)</span>
<span id="cb3-2"><a href="" aria-hidden="true" tabindex="-1"></a>r_dist <span class="ot">&lt;-</span> <span class="fu">mask</span>(r_dist, r)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="raster-operations_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-zonal-1" class="slide level2">
<h2>Zonal</h2>
<ul>
<li>Zonal operations apply an aggregation function to multiple raster cells</li>
<li>A second raster with categorical values define the ‚Äúzones‚Äù</li>
</ul>
<p>What is the mean altitude <em>per municipality</em>?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="" aria-hidden="true" tabindex="-1"></a>mean_vals <span class="ot">&lt;-</span> <span class="fu">zonal</span>(r, zones, <span class="at">fun =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell column-page quarto-layout-panel" data-layout-nrow="1">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-zonal-1" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-zonal-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="raster-operations_files/figure-html/fig-zonal-1.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zonal-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: The original Zones (E.g. municipalities of Luxembourg)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-zonal-2" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-zonal-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="raster-operations_files/figure-html/fig-zonal-2.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zonal-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Mean elevation per zone / per municipality
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<ul>
<li>The global operation can be seen as a special case of a zonal operation, where the only ‚ÄúZone‚Äù is the entire dataset</li>
</ul>
</div>
</div>
</div>
</section>
<section id="local-1" class="slide level2">
<h2>Local (1)</h2>
<ul>
<li>Local operations comprise all cell-by-cell operations in one or several layers.</li>
<li>For example, we can classify the elevation into values above and below a certain threshold</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># first, create a boolean copy of the raster</span></span>
<span id="cb5-2"><a href="" aria-hidden="true" tabindex="-1"></a>r_bool <span class="ot">&lt;-</span> <span class="fu">as.logical</span>(r)</span>
<span id="cb5-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="" aria-hidden="true" tabindex="-1"></a>mean_elev <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mean_elev)</span>
<span id="cb5-5"><a href="" aria-hidden="true" tabindex="-1"></a>mean_elev</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 347.6488</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="" aria-hidden="true" tabindex="-1"></a>r_bool[r <span class="sc">&gt;</span> mean_elev] <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb7-2"><a href="" aria-hidden="true" tabindex="-1"></a>r_bool[r <span class="sc">&lt;=</span> mean_elev] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>

<img data-src="raster-operations_files/figure-html/unnamed-chunk-11-1.png" width="672" class="r-stretch"></section>
<section id="local-2" class="slide level2">
<h2>Local (2)</h2>
<ul>
<li>This type of (re-) classification is a very common operation</li>
<li>For more than 2 categories, we can use <code>classify</code></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="" aria-hidden="true" tabindex="-1"></a>cuts <span class="ot">&lt;-</span> <span class="fu">global</span>(r, quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">33</span>, .<span class="dv">66</span>, <span class="dv">1</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="" aria-hidden="true" tabindex="-1"></a>r_classify <span class="ot">&lt;-</span> <span class="fu">classify</span>(r, <span class="fu">as.numeric</span>(cuts))</span>
<span id="cb8-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># this next line just replaces the default labels with some custom ones</span></span>
<span id="cb8-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(r_classify) <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">category =</span> <span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"mid"</span>,<span class="st">"high"</span>))</span>
<span id="cb8-7"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">tm_shape</span>(r_classify) <span class="sc">+</span></span>
<span id="cb8-9"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">"cat"</span>,<span class="at">legend.show =</span> <span class="cn">TRUE</span>, <span class="at">palette =</span> <span class="st">"viridis"</span>, <span class="at">title =</span> <span class="st">"Elevation"</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">legend.show =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>

</div>
<img data-src="raster-operations_files/figure-html/unnamed-chunk-12-1.png" width="672" class="r-stretch"></section>
<section id="local-3" class="slide level2">
<h2>Local (3)</h2>
<ul>
<li>Local operations are often used with multiple bands</li>
<li>For example, we could calculate the mean intensity values of red, green and blue:</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="" aria-hidden="true" tabindex="-1"></a>l7 <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">system.file</span>(<span class="st">"tif/L7_ETMs.tif"</span>,<span class="at">package =</span> <span class="st">"stars"</span>))</span>
<span id="cb9-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(l7) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"B"</span>, <span class="st">"G"</span>, <span class="st">"R"</span>, <span class="st">"NIR"</span>, <span class="st">"SWIR"</span>, <span class="st">"MIR"</span>)</span>
<span id="cb9-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="" aria-hidden="true" tabindex="-1"></a>l7_rgb <span class="ot">&lt;-</span> l7[[<span class="fu">c</span>(<span class="st">"R"</span>,<span class="st">"G"</span>, <span class="st">"B"</span>)]]</span>
<span id="cb9-6"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(l7_rgb, <span class="at">nr =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="raster-operations_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="" aria-hidden="true" tabindex="-1"></a>l7_rgb_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(l7_rgb)</span>
<span id="cb10-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(l7_rgb_mean)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="raster-operations_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="local-4" class="slide level2">
<h2>Local (4)</h2>
<ul>
<li>In a more complex usecase, we could use the R, G and B band to calculate a grayscale value (<span class="math inline">\(L^*\)</span>) using the following formula (from <a href="https://stackoverflow.com/a/689547/4139249">here</a>):</li>
</ul>
<span class="math display">\[\begin{aligned}

L^* &amp;= 116 \times Y ^ {\frac{1}{3}} - 16\\

Y &amp;= 0.2126 \times R^\gamma+0.7152 \times G^\gamma+0.0722 \times B^\gamma \\


\gamma &amp;= 2.2

\end{aligned}\]</span>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fl">2.2</span></span>
<span id="cb11-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="" aria-hidden="true" tabindex="-1"></a>l7 <span class="ot">&lt;-</span> l7<span class="sc">/</span><span class="dv">255</span> <span class="co"># scale values to 0-1 (probabbly not necessary)</span></span>
<span id="cb11-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fl">0.2126</span> <span class="sc">*</span> l7[[<span class="st">"R"</span>]]<span class="sc">^</span>g <span class="sc">+</span> <span class="fl">0.7152</span> <span class="sc">*</span> l7[[<span class="st">"G"</span>]]<span class="sc">^</span>g <span class="sc">+</span> <span class="fl">0.0722</span> <span class="sc">*</span> l7[[<span class="st">"B"</span>]]<span class="sc">^</span>g</span>
<span id="cb11-6"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="dv">116</span><span class="sc">*</span> Y<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">-</span><span class="dv">16</span></span>
<span id="cb11-8"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the result</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>

<img data-src="raster-operations_files/figure-html/unnamed-chunk-16-1.png" width="672" class="r-stretch"></section>
<section id="sec-focal-1" class="slide level2">
<h2>Focal</h2>
<ul>
<li>While local functions operate on one cell focal operations take into account a central (focal) cell <em>and its neighbors</em>.</li>
<li>The neighborhood (also named kernel, filter or moving window) under consideration is typically of size 3-by-3 cells (that is the central cell and its eight surrounding neighbors), but can take on any other size or shape as defined by the user.</li>
<li>A focal operation applies an aggregation function to all cells within the specified neighborhood, uses the corresponding output as the new value for the central cell, and moves on to the next central cell</li>
</ul>
<div id="fig-focal" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-focal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="images/focal.png">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-focal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Note how, depending on the size of your moving window, NA‚Äôs are produced. Source: <span class="citation" data-cites="lovelace2019">Lovelace, Nowosad, and Muenchow (<a href="#/tasks" role="doc-biblioref" onclick="">2019</a>)</span>
</figcaption>
</figure>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="" aria-hidden="true" tabindex="-1"></a>focal3by3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">9</span>), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb12-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="" aria-hidden="true" tabindex="-1"></a>focal11by11 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">121</span>), <span class="at">ncol =</span> <span class="dv">11</span>)</span>
<span id="cb12-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="" aria-hidden="true" tabindex="-1"></a>r_foc3 <span class="ot">&lt;-</span> <span class="fu">focal</span>(r, focal3by3, <span class="at">fun =</span> mean, <span class="at">fillNA =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-8"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="" aria-hidden="true" tabindex="-1"></a>r_foc11 <span class="ot">&lt;-</span> <span class="fu">focal</span>(r, focal11by11, <span class="at">fun =</span> mean, <span class="at">fillNA =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell column-page quarto-layout-panel" data-layout-nrow="1">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-focal2-1" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-focal2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="raster-operations_files/figure-html/fig-focal2-1.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-focal2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Original values
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-focal2-2" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-focal2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="raster-operations_files/figure-html/fig-focal2-2.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-focal2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Result of a 3x3 Focal Window
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-focal2-3" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-focal2-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="raster-operations_files/figure-html/fig-focal2-3.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-focal2-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Result of a 11x11 Focal Window
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Note how the output raster is smaller as the focal window is larger (edge effect)</li>
</ul>
</div>
</div>
</div>
</section>
<section id="focal-weights-1" class="slide level2">
<h2>Focal weights (1)</h2>
<ul>
<li>The focal weights we used above were square and evenly weighted</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="" aria-hidden="true" tabindex="-1"></a>focal3by3</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    1    1
[2,]    1    1    1
[3,]    1    1    1</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="" aria-hidden="true" tabindex="-1"></a>focal11by11</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11]
 [1,]    1    1    1    1    1    1    1    1    1     1     1
 [2,]    1    1    1    1    1    1    1    1    1     1     1
 [3,]    1    1    1    1    1    1    1    1    1     1     1
 [4,]    1    1    1    1    1    1    1    1    1     1     1
 [5,]    1    1    1    1    1    1    1    1    1     1     1
 [6,]    1    1    1    1    1    1    1    1    1     1     1
 [7,]    1    1    1    1    1    1    1    1    1     1     1
 [8,]    1    1    1    1    1    1    1    1    1     1     1
 [9,]    1    1    1    1    1    1    1    1    1     1     1
[10,]    1    1    1    1    1    1    1    1    1     1     1
[11,]    1    1    1    1    1    1    1    1    1     1     1</code></pre>
</div>
</div>
</section>
<section id="focal-weights-2" class="slide level2">
<h2>Focal weights (2)</h2>
<ul>
<li>However, we can also create uneven weights:</li>
</ul>
<p>For example, a <a href="https://de.wikipedia.org/wiki/Laplace-Filter">laplacian filter</a> is commonly used for edge detection.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="" aria-hidden="true" tabindex="-1"></a>laplacian <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">nrow=</span><span class="dv">3</span>) </span>
<span id="cb17-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="" aria-hidden="true" tabindex="-1"></a>laplacian</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    0    1    0
[2,]    1   -4    1
[3,]    0    1    0</code></pre>
</div>
</div>
<p>So are the <a href="https://en.wikipedia.org/wiki/Sobel_operator">sobel filters</a></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]   -1    0    1
[2,]   -2    0    2
[3,]   -1    0    1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    2    1
[2,]    0    0    0
[3,]   -1   -2   -1</code></pre>
</div>
</div>
<div class="cell column-page quarto-layout-panel" data-layout-nrow="1">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-edgedetection-1" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-edgedetection-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="raster-operations_files/figure-html/fig-edgedetection-1.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-edgedetection-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Laplacian Filter
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-edgedetection-2" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-edgedetection-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="raster-operations_files/figure-html/fig-edgedetection-2.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-edgedetection-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Sobel (x-direction)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-edgedetection-3" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-edgedetection-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="raster-operations_files/figure-html/fig-edgedetection-3.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-edgedetection-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: SObel (y-direction)
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="focal-weights-3" class="slide level2">
<h2>Focal weights (3)</h2>
<ul>
<li>We can also create specific <em>shapes</em> using weights</li>
<li>We don‚Äôt need to create these matrices by hand. Rather, we can use the function <code>focalMat</code> to create different shapes automatically</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Note </span></span>
<span id="cb21-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># - "d" is evaluated in the units of "x" (in our case: meters)</span></span>
<span id="cb21-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># - The sum of all weights equals to 1</span></span>
<span id="cb21-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># - Note how the edges receive a value of 0</span></span>
<span id="cb21-5"><a href="" aria-hidden="true" tabindex="-1"></a>focal_circle3000 <span class="ot">&lt;-</span> <span class="fu">focalMat</span>(<span class="at">x =</span> r, <span class="at">d =</span> <span class="dv">3000</span>, <span class="st">"circle"</span>)</span>
<span id="cb21-6"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="" aria-hidden="true" tabindex="-1"></a>focal_circle3000</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]       [,2]       [,3]       [,4]       [,5]
[1,] 0.00000000 0.00000000 0.03703704 0.00000000 0.00000000
[2,] 0.03703704 0.03703704 0.03703704 0.03703704 0.03703704
[3,] 0.03703704 0.03703704 0.03703704 0.03703704 0.03703704
[4,] 0.03703704 0.03703704 0.03703704 0.03703704 0.03703704
[5,] 0.03703704 0.03703704 0.03703704 0.03703704 0.03703704
[6,] 0.03703704 0.03703704 0.03703704 0.03703704 0.03703704
[7,] 0.00000000 0.00000000 0.03703704 0.00000000 0.00000000</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="raster-operations_files/figure-html/unnamed-chunk-23-1.png" width="672"></p>
<figcaption>A visual representation of the matrix / filter above</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="" aria-hidden="true" tabindex="-1"></a>focal_gauss1000 <span class="ot">&lt;-</span> <span class="fu">focalMat</span>(<span class="at">x =</span> r, <span class="at">d =</span> <span class="dv">1000</span>, <span class="st">"Gauss"</span>)</span>
<span id="cb23-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="" aria-hidden="true" tabindex="-1"></a>focal_gauss1000</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]        [,2]        [,3]        [,4]        [,5]
[1,] 0.000241551 0.001082556 0.001784834 0.001082556 0.000241551
[2,] 0.002942693 0.013188236 0.021743725 0.013188236 0.002942693
[3,] 0.013188236 0.059105572 0.097448614 0.059105572 0.013188236
[4,] 0.021743725 0.097448614 0.160665602 0.097448614 0.021743725
[5,] 0.013188236 0.059105572 0.097448614 0.059105572 0.013188236
[6,] 0.002942693 0.013188236 0.021743725 0.013188236 0.002942693
[7,] 0.000241551 0.001082556 0.001784834 0.001082556 0.000241551</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="raster-operations_files/figure-html/unnamed-chunk-25-1.png" width="672"></p>
<figcaption>A visual representation of the matrix / filter above</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="focal-functions-in-terrain-processing" class="slide level2">
<h2>Focal functions in terrain processing</h2>
<ul>
<li>Focal functions are used to calculate the slope of a specific location, e.g.&nbsp;using the algorithm by <span class="citation" data-cites="horn1981">Horn (<a href="#/tasks" role="doc-biblioref" onclick="">1981</a>)</span></li>
<li>Similarly, calculating the aspect (azimuth) of a location is a very typical task when dealing with elevation data</li>
<li>These algorithms are used so often, that they are implemented in a dedicated function (<code>terrain()</code>)</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">terrain</span>(r, <span class="st">"slope"</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb25-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">terrain</span>(r, <span class="st">"aspect"</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell column-page quarto-layout-panel" data-layout-nrow="1">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-terrain-1" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-terrain-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="raster-operations_files/figure-html/fig-terrain-1.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-terrain-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Calculating slope using a predefined algorithm
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-terrain-2" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-terrain-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="raster-operations_files/figure-html/fig-terrain-2.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-terrain-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Calculating aspect
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="tasks" class="slide level2 smaller scrollable">
<h2>ü™ï Tasks</h2>
<ol type="1">
<li><p>Import the elevation of Luxembourg using the following code:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">system.file</span>(<span class="st">"ex/elev.tif"</span>, <span class="at">package=</span><span class="st">"terra"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div></li>
<li><p>Calculate the mean, maximum and minimum elevation values</p></li>
<li><p>Calculate slope and aspect (see <a href="https://rspatial.github.io/terra/reference/terrain.html">terrain functions</a>)</p></li>
<li><p>Determine suitable locations of solar panels using the following conditions:</p>
<ul>
<li>Elevation: above 300 MASL</li>
<li>Slope: Between 1 and 3¬∞</li>
<li>Aspect: Southfacing (between 135 and 235¬∞)</li>
</ul></li>
<li><p>Download the Municipalities of Luxembourg from Moodle and calculate the minimum, maximum and mean elevation values per municipality.</p></li>
<li><p>Smooth the elevation values using different focal windows</p></li>
<li><p>Import the multispectral Landsat 7 as a raster using the following path</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">system.file</span>(<span class="st">"tif/L7_ETMs.tif"</span>,<span class="at">package =</span> <span class="st">"stars"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div></li>
<li><p>Calculate the <a href="https://en.wikipedia.org/wiki/Normalized_difference_vegetation_index">NDVI</a> using the following formula:</p></li>
</ol>
<p><span class="math display">\[\text{NDVI} = \frac{\text{NIR}-\text{red}}{\text{NIR}+\text{red}}\]</span></p>


<img data-src="raster-operations_files/figure-html/unnamed-chunk-29-1.png" width="672" class="r-stretch quarto-figure-center"><p class="caption">The resulting NDVI values</p><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-horn1981" class="csl-entry" role="listitem">
Horn, Berthold KP. 1981. <span>‚ÄúHill Shading and the Reflectance Map.‚Äù</span> <em>Proceedings of the IEEE</em> 69 (1): 14‚Äì47.
</div>
<div id="ref-lovelace2019" class="csl-entry" role="listitem">
Lovelace, Robin, Jakub Nowosad, and Jannes Muenchow. 2019. <em>Geocomputation with r</em>. Chapman; Hall/CRC.
</div>
</div>
</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p><a href="../index.html">home</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="raster-operations_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="raster-operations_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="raster-operations_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="raster-operations_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="raster-operations_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="raster-operations_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="raster-operations_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="raster-operations_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="raster-operations_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="raster-operations_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>